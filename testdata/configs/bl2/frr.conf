frr version 8.5.1_git
frr defaults traditional
hostname bl2
no ipv6 forwarding
!
vrf Vrf_one
 vni 1
exit-vrf
!
vrf Vrf_two
 vni 2
exit-vrÂ´
!
vrf Vrf_boot
 vni 10
exit-vrf
!
vrf Vrf_mgmt
 vni 20
exit-vrf
!
vrf Vrf_storage
 vni 30
exit-vrf
!
vrf Vrf_internet
 vni 42
exit-vrf
!
router bgp 64497
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 neighbor eth2 interface remote-as external
 neighbor eth3 interface remote-as external
 !
 address-family ipv4 unicast
  network 192.0.2.2/32
 exit-address-family
 !
 address-family l2vpn evpn
  neighbor eth2 activate
  neighbor eth3 activate
  advertise-all-vni
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_one
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 neighbor 192.168.101.1 remote-as 64512
 neighbor fd00:cafe:101::1 remote-as 64512
 !
 address-family ipv4 unicast
  neighbor 192.168.101.1 activate
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor fd00:cafe:101::1 activate
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_two
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 neighbor 192.168.102.1 remote-as 64512
 neighbor fd00:cafe:102::1 remote-as 64512
 !
 address-family ipv4 unicast
  neighbor 192.168.102.1 activate
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor fd00:cafe:102::1 activate
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_boot
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 !
 address-family ipv4 unicast
  import vrf route-map rm_import_Vrfs_to_Vrf_boot
  import vrf Vrf_mgmt
 exit-address-family
 !
 address-family ipv6 unicast
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_mgmt
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 neighbor 192.168.115.1 remote-as 64512
 neighbor fd00:cafe:115::1 remote-as 64512
 neighbor eth4 interface remote-as 64520
 !
 address-family ipv4 unicast
  neighbor 192.168.115.1 activate
  neighbor eth4 activate
  import vrf route-map rm_import_Vrfs_to_Vrf_mgmt
  import vrf Vrf_boot
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor fd00:cafe:115::1 activate
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_storage
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 neighbor 192.168.116.1 remote-as 64512
 neighbor fd00:cafe:116::1 remote-as 64512
 !
 address-family ipv4 unicast
  neighbor 192.168.116.1 activate
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor fd00:cafe:116::1 activate
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
router bgp 64497 vrf Vrf_internet
 bgp router-id 192.0.2.2
 no bgp ebgp-requires-policy
 no bgp default ipv4-unicast
 neighbor 192.168.103.1 remote-as 64512
 neighbor fd00:cafe:103::1 remote-as 64512
 !
 address-family ipv4 unicast
  neighbor 192.168.103.1 activate
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor fd00:cafe:103::1 activate
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
exit
!
# TODO: change these imports to something different.
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 5 permit 10.27.49.128/25
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 10 permit 10.27.50.128/25
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 15 permit 10.27.53.192/26
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 20 permit 10.27.54.192/26
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 25 permit 10.90.106.224/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 30 permit 10.90.107.128/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 35 permit 10.92.244.17/32
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 40 permit 10.92.244.18/32
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 45 permit 10.90.221.0/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 50 permit 10.90.221.16/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 55 permit 10.90.221.32/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 60 permit 10.90.221.48/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 65 permit 10.90.221.64/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 70 permit 10.90.24.0/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 75 permit 10.90.24.16/28
ip prefix-list pl_import_Vrf_mgmt_to_Vrf_boot seq 80 permit 100.64.0.0/30

ip prefix-list pl_import_Vrf_boot_to_Vrf_mgmt seq 5 permit 10.89.40.0/23 le 32
!
route-map rm_import_Vrfs_to_Vrf_boot permit 10
 match ip address prefix-list pl_import_Vrf_mgmt_to_Vrf_boot
 match source-vrf Vrf_mgmt
!
route-map rm_import_Vrfs_to_Vrf_mgmt permit 10
 match ip address prefix-list pl_import_Vrf_boot_to_Vrf_mgmt
 match source-vrf Vrf_boot
!